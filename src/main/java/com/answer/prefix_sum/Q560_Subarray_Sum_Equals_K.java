package com.answer.prefix_sum;

import java.util.HashMap;

public class Q560_Subarray_Sum_Equals_K {
    /**
     * é¢˜ç›®è¦æ±‚è¿ç»­å­æ•°ç»„çš„å’Œç­‰äºå®šå€¼kï¼Œä¸€èˆ¬æ¥è¯´ï¼Œçœ‹åˆ°è¿ç»­å­æ•°ç»„å…ƒç´ ç›¸å…³çš„ï¼ŒåŸºæœ¬å°±æ˜¯æ»‘åŠ¨çª—å£æˆ–è€…å‰ç¼€å’Œï¼ˆç¬¨äººé¢˜åˆ·å¾—ä¸å¤šï¼Œåªèƒ½æ€»ç»“å‡ºè¿™ä¸¤ä¸ªï¼‰ï¼Œ
     * è€Œæ»‘åŠ¨çª—å£çš„ä½¿ç”¨éœ€è¦æ»¡è¶³å‰ç½®æ¡ä»¶ï¼šçª—å£å†…çš„å…ƒç´ å¿…é¡»è¦æœ‰â€œå•è°ƒæ€§â€ï¼Œä¹Ÿå°±æ˜¯è¯´æ–°å…ƒç´ è¿›å…¥çª—å£å¿…é¡»ä½¿å¾—å†…éƒ¨å’Œä¸èƒ½å‡å°‘ï¼Œå¿…é¡»ä½¿å¾—çª—å£å‘ç€ä¸æ»¡è¶³çº¦æŸçš„æ–¹å‘å‰è¿›ã€‚
     * ç”±äºæ•°ç»„å­˜åœ¨è´Ÿæ•°ï¼Œå› æ­¤æ–°å…¥å…ƒç´ åè€Œå¯èƒ½ä½¿å¾—çª—å£æ›´åŠ ä¸è¶…è¿‡kã€‚å› æ­¤æ’é™¤æ»‘åŠ¨çª—å£ï¼Œæƒ³åˆ°ä½¿ç”¨å‰ç¼€å’Œã€‚
     * å‰ç¼€å’Œçš„ä¼˜åŠ¿å°±åœ¨äºèƒ½å¤Ÿå°†å­æ•°ç»„æ±‚å’Œçš„æ—¶é—´ä¼˜åŒ–åˆ°ğ‘‚(1)
     */
    public int subarraySum(int[] nums, int k) {
        //è®¡ç®—å‰ç¼€å’Œæ•°ç»„
        int len = nums.length;
        int[] prefixSum = new int[len + 1];
        prefixSum[0] = 0;
        for (int i = 0; i < len; i++) {
            prefixSum[i + 1] = prefixSum[i] + nums[i];
        }

        int result = 0;
        HashMap<Integer, Integer> map = new HashMap<>();
        for (int sum : prefixSum) {
            int index = sum - k;
            if (map.containsKey(index)) { //å·²éå†å…ƒç´ ä¸­å­˜åœ¨index
                result += map.get(index);  //åŠ ä¸Šç›¸åº”çš„ä¸ªæ•°
            }
            map.put(sum, map.getOrDefault(sum, 0) + 1); //å½“å‰éå†ç»“æŸï¼Œæ›´æ–°sumå‡ºç°ä¸ªæ•°ï¼Œä¾¿äºåç»­åˆ¤æ–­ä½¿ç”¨
        }
        return result;
    }
}
